{"ast":null,"code":"var _jsxFileName = \"/Users/Gary 1/Desktop/Code stuff/\\u8CC7\\u7B56\\u6703/\\u5C08\\u984C/\\u5927\\u5C08/artddict-react/src/pages/cart/CartProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { ReactComponent as Logo } from \"@svgr/webpack?-svgo,+titleProp,+ref!../../pics/logo-bk.svg\";\nimport { Link } from 'react-router-dom';\nimport { Nav } from 'react-bootstrap';\nimport '../../bootstrap/css/bootstrap.css';\nimport './styles/cart-product.scss';\nimport Cookies from 'universal-cookie'; // demo\n\nimport fakedata from './data/fakedata';\nimport Main from './demo/Main';\nimport Basket from './demo/Basket'; // // imgae\n// import img1 from './img/1.png'\n// import img2 from './img/2.png'\n// // icon\n// import { FaRegEdit } from 'react-icons/fa'\n// import { FaLock } from 'react-icons/fa'\n// import { RiDeleteBinLine } from 'react-icons/ri'\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction CartProduct() {\n  _s();\n\n  const {\n    products\n  } = fakedata;\n  const [cartItems, setCartItems] = useState([]);\n  const cookies = new Cookies();\n\n  async function getEventServer() {\n    const url = 'http://localhost:6005/event/'; // 注意header資料格式要設定，伺服器才知道是json格式\n\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'appliaction/json'\n      })\n    }); // fetch是呼叫後台api, response=得到的資料\n\n    const response = await fetch(request);\n    console.log(response);\n    const data = await response.json();\n    console.log(data);\n  } // 呼叫剛剛的assync func\n\n\n  useEffect(() => {\n    getEventServer();\n  }, []);\n  /**\n   * 當頁面Load時，讀取Cookie值並更新至cartItems\n   */\n\n  useEffect(() => {\n    let tempArr = [];\n    let cookieProductArr = cookies.get('product'); // get Cookies\n\n    if (cookieProductArr) {\n      for (let i = 0; i < cookieProductArr.length; i++) {\n        let product = cookieProductArr[i];\n        tempArr.push(product);\n      }\n\n      setCartItems(tempArr);\n    }\n  }, []);\n  /**\n   * 更新 Product Cookie\n   *\n   * @param {Object} product 欲改變的目標 product.\n   * @param {number} quantityNum 欲更新product.qty到的數字.\n   * @param {string} type 根據不同type，product.qty 更新方法不同\n   *\n   *\n   */\n\n  const onCookie = (product, quantityNum, type) => {\n    let updateCookie = [];\n    let cookieProduct = cookies.get('product'); // 取得 product cookie\n\n    if (cookieProduct) {\n      // 如果有已存在的 product cookie\n      // 查看cookie裡面的 product id\n      const idSet = new Set();\n\n      for (let i in cookieProduct) {\n        idSet.add(cookieProduct[i].id);\n      } // 如果被改變的product 在 product cookie 中\n\n\n      if (idSet.has(product.id)) {\n        for (let i in cookieProduct) {\n          if (cookieProduct[i].id == product.id) {\n            if (type == 'add') // 如果event是從AddToCart,數量+1\n              cookieProduct[i].qty += 1;else {\n              // 如果event是從Input,數量直接到指定數字\n              cookieProduct[i].qty = Number(quantityNum);\n            }\n          }\n        }\n      } else {\n        // 如果被改變的product 不在 product cookie 中\n        // 初始數量為1\n        product.qty = 1;\n        cookieProduct.push(product);\n      } // 如果被改變後的product數量>0，加入在cookie 中\n\n\n      for (let i in cookieProduct) {\n        if (cookieProduct[i].qty > 0) {\n          updateCookie.push(cookieProduct[i]);\n        }\n      }\n    } else {\n      // 如果沒有已存在的 product cookie\n      // 初始數量為1\n      product.qty = 1;\n      updateCookie.push(product);\n    }\n\n    cookies.set('product', updateCookie); //更新Cookie\n  };\n  /**\n   * 加進購物車\n   *\n   * @param {Object} product 欲改變的目標 product.\n   * @param {number} quantityNum 欲更新product.qty到的數字.\n   *\n   */\n\n\n  const onAddToCart = (product, quantityNum) => {\n    onCookie(product, quantityNum, 'add');\n    const exist = cartItems.find(x => x.id === product.id);\n\n    if (exist) {\n      setCartItems(cartItems.map(x => x.id === product.id ? { ...exist,\n        qty: exist.qty + 1\n      } : x));\n    } else {\n      setCartItems([...cartItems, { ...product,\n        qty: 1\n      }]);\n    }\n  };\n  /**\n   * 更新購物車數量\n   *\n   * @param {Object} product 欲改變的目標 product.\n   * @param {number} quantityNum 欲更新product.qty到的數字.\n   *\n   */\n\n\n  const onCartNumChange = (product, quantityNum) => {\n    const exist = cartItems.find(x => x.id === product.id);\n    onCookie(product, quantityNum, 'set');\n\n    if (quantityNum <= 0) {\n      setCartItems(cartItems.filter(x => x.id !== product.id));\n    } else {\n      setCartItems(cartItems.map(x => x.id === product.id ? { ...exist,\n        qty: Number(quantityNum)\n      } : x));\n    }\n  };\n  /**\n   * 移出購物車\n   *\n   * @param {Object} product 欲改變的目標 product.\n   *\n   */\n\n\n  const onDelete = product => {\n    onCookie(product, 0, 'set');\n    const exist = cartItems.find(x => x.id === product.id);\n\n    if (exist.qty >= 1) {\n      setCartItems(cartItems.filter(x => x.id !== product.id));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-bg\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"c-header\",\n        children: [/*#__PURE__*/_jsxDEV(Logo, {\n          className: \"c-logo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Hello JoJo\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"c-crumbs\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u9996\\u9801\\xA0/\\xA0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\u8CFC\\u7269\\u8ECA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 193,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"c-tabs\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-tab-product\",\n          children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n            as: Link,\n            to: \"/cart-product\",\n            children: \"\\u7F8E\\u8853\\u9928\\u5546\\u54C1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-tab-event\",\n          children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n            as: Link,\n            to: \"/cart-event\",\n            children: \"\\u6D3B\\u52D5\\u7968\\u5377\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-tab-auction\",\n          children: /*#__PURE__*/_jsxDEV(Nav.Link, {\n            as: Link,\n            to: \"/cart-auction\",\n            children: \"\\u5F97\\u6A19\\u5546\\u54C1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Main, {\n        products: products,\n        onAddToCart: onAddToCart\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Basket, {\n        cartItems: cartItems,\n        onAddToCart: onAddToCart,\n        onCartNumChange: onCartNumChange,\n        onDelete: onDelete\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(CartProduct, \"jdONvkEabzLc64SbXgqXBHRMg9M=\");\n\n_c = CartProduct;\nexport default CartProduct;\n\nvar _c;\n\n$RefreshReg$(_c, \"CartProduct\");","map":{"version":3,"sources":["/Users/Gary 1/Desktop/Code stuff/資策會/專題/大專/artddict-react/src/pages/cart/CartProduct.js"],"names":["React","useState","useEffect","Link","Nav","Cookies","fakedata","Main","Basket","CartProduct","products","cartItems","setCartItems","cookies","getEventServer","url","request","Request","method","headers","Headers","Accept","response","fetch","console","log","data","json","tempArr","cookieProductArr","get","i","length","product","push","onCookie","quantityNum","type","updateCookie","cookieProduct","idSet","Set","add","id","has","qty","Number","set","onAddToCart","exist","find","x","map","onCartNumChange","filter","onDelete"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { ReactComponent as Logo } from '../../pics/logo-bk.svg'\nimport { Link } from 'react-router-dom'\nimport { Nav } from 'react-bootstrap'\nimport '../../bootstrap/css/bootstrap.css'\nimport './styles/cart-product.scss'\nimport Cookies from 'universal-cookie'\n\n// demo\nimport fakedata from './data/fakedata'\nimport Main from './demo/Main'\nimport Basket from './demo/Basket'\n\n// // imgae\n// import img1 from './img/1.png'\n// import img2 from './img/2.png'\n\n// // icon\n// import { FaRegEdit } from 'react-icons/fa'\n// import { FaLock } from 'react-icons/fa'\n// import { RiDeleteBinLine } from 'react-icons/ri'\n\nfunction CartProduct() {\n  const { products } = fakedata\n  const [cartItems, setCartItems] = useState([])\n  const cookies = new Cookies()\n\n  async function getEventServer() {\n\n    const url = 'http://localhost:6005/event/'\n\n    // 注意header資料格式要設定，伺服器才知道是json格式\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'appliaction/json',\n      }),\n    })\n    // fetch是呼叫後台api, response=得到的資料\n    const response = await fetch(request)\n    console.log(response)\n    const data = await response.json()\n    console.log(data)\n  }\n\n  // 呼叫剛剛的assync func\n  useEffect(() => {\n    getEventServer()\n  }, [])\n\n  /**\n   * 當頁面Load時，讀取Cookie值並更新至cartItems\n   */\n  useEffect(() => {\n    let tempArr = []\n    let cookieProductArr = cookies.get('product') // get Cookies\n    if (cookieProductArr) {\n      for (let i = 0; i < cookieProductArr.length; i++) {\n        let product = cookieProductArr[i]\n        tempArr.push(product)\n      }\n      setCartItems(tempArr)\n    }\n  }, [])\n\n  /**\n   * 更新 Product Cookie\n   *\n   * @param {Object} product 欲改變的目標 product.\n   * @param {number} quantityNum 欲更新product.qty到的數字.\n   * @param {string} type 根據不同type，product.qty 更新方法不同\n   *\n   *\n   */\n  const onCookie = (product, quantityNum, type) => {\n    let updateCookie = []\n    let cookieProduct = cookies.get('product') // 取得 product cookie\n    if (cookieProduct) {\n      // 如果有已存在的 product cookie\n      // 查看cookie裡面的 product id\n      const idSet = new Set()\n      for (let i in cookieProduct) {\n        idSet.add(cookieProduct[i].id)\n      }\n      // 如果被改變的product 在 product cookie 中\n      if (idSet.has(product.id)) {\n        for (let i in cookieProduct) {\n          if (cookieProduct[i].id == product.id) {\n            if (type == 'add')\n              // 如果event是從AddToCart,數量+1\n              cookieProduct[i].qty += 1\n            else {\n              // 如果event是從Input,數量直接到指定數字\n              cookieProduct[i].qty = Number(quantityNum)\n            }\n          }\n        }\n      } else {\n        // 如果被改變的product 不在 product cookie 中\n        // 初始數量為1\n        product.qty = 1\n        cookieProduct.push(product)\n      }\n      // 如果被改變後的product數量>0，加入在cookie 中\n      for (let i in cookieProduct) {\n        if (cookieProduct[i].qty > 0) {\n          updateCookie.push(cookieProduct[i])\n        }\n      }\n    } else {\n      // 如果沒有已存在的 product cookie\n      // 初始數量為1\n      product.qty = 1\n      updateCookie.push(product)\n    }\n    cookies.set('product', updateCookie) //更新Cookie\n  }\n\n  /**\n   * 加進購物車\n   *\n   * @param {Object} product 欲改變的目標 product.\n   * @param {number} quantityNum 欲更新product.qty到的數字.\n   *\n   */\n  const onAddToCart = (product, quantityNum) => {\n    onCookie(product, quantityNum, 'add')\n    const exist = cartItems.find((x) => x.id === product.id)\n    if (exist) {\n      setCartItems(\n        cartItems.map((x) =>\n          x.id === product.id\n            ? { ...exist, qty: exist.qty + 1 }\n            : x\n        )\n      )\n    } else {\n      setCartItems([...cartItems, { ...product, qty: 1 }])\n    }\n  }\n\n  /**\n   * 更新購物車數量\n   *\n   * @param {Object} product 欲改變的目標 product.\n   * @param {number} quantityNum 欲更新product.qty到的數字.\n   *\n   */\n  const onCartNumChange = (product, quantityNum) => {\n    const exist = cartItems.find((x) => x.id === product.id)\n    onCookie(product, quantityNum, 'set')\n    if (quantityNum <= 0) {\n      setCartItems(\n        cartItems.filter((x) => x.id !== product.id)\n      )\n    } else {\n      setCartItems(\n        cartItems.map((x) =>\n          x.id === product.id\n            ? { ...exist, qty: Number(quantityNum) }\n            : x\n        )\n      )\n    }\n  }\n\n  /**\n   * 移出購物車\n   *\n   * @param {Object} product 欲改變的目標 product.\n   *\n   */\n  const onDelete = (product) => {\n    onCookie(product, 0, 'set')\n    const exist = cartItems.find((x) => x.id === product.id)\n    if (exist.qty >= 1) {\n      setCartItems(\n        cartItems.filter((x) => x.id !== product.id)\n      )\n    }\n  }\n\n  return (\n    <>\n      <div className=\"c-bg\">\n        <div className=\"c-header\">\n          <Logo className=\"c-logo\" />\n          <p>Hello JoJo</p>\n        </div>\n        <div className=\"c-crumbs\">\n          <p>首頁&nbsp;/&nbsp;</p>\n          <p>購物車</p>\n        </div>\n        <div className=\"c-tabs\">\n          <div className=\"c-tab-product\">\n            <Nav.Link as={Link} to=\"/cart-product\">\n              美術館商品\n            </Nav.Link>\n          </div>\n          <div className=\"c-tab-event\">\n            <Nav.Link as={Link} to=\"/cart-event\">\n              活動票卷\n            </Nav.Link>\n          </div>\n          <div className=\"c-tab-auction\">\n            <Nav.Link as={Link} to=\"/cart-auction\">\n              得標商品\n            </Nav.Link>\n          </div>\n        </div>\n\n        <Main\n          products={products}\n          onAddToCart={onAddToCart}\n        ></Main>\n        <Basket\n          cartItems={cartItems}\n          onAddToCart={onAddToCart}\n          onCartNumChange={onCartNumChange}\n          onDelete={onDelete}\n        ></Basket>\n      </div>\n    </>\n  )\n}\n\nexport default CartProduct\n"]},"metadata":{},"sourceType":"module"}