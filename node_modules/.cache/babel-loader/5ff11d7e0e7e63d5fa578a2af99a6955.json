{"ast":null,"code":"var _jsxFileName = \"/Users/Gary 1/Desktop/Code stuff/\\u8CC7\\u7B56\\u6703/\\u5C08\\u984C/\\u5927\\u5C08/artddict-react/src/pages/cart/components/BasketAuction.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Cookies from 'universal-cookie';\nimport AuctionCountDown from './AuctionCountDown';\nimport { Modal, Button } from 'react-bootstrap'; // icon\n\nimport { FaRegEdit } from 'react-icons/fa';\nimport { FaLock } from 'react-icons/fa';\nimport { RiDeleteBinLine } from 'react-icons/ri';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction BasketEvent() {\n  _s();\n\n  //假設會員id\n  const [memberid, setMemberId] = useState(''); //驗證身分\n\n  async function getjwtvertifyFromServer() {\n    const token = localStorage.getItem('token');\n    const response = await fetch('http://localhost:6005/users/checklogin', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        token\n      })\n    });\n    const data = await response.json();\n    console.log(data);\n    setMemberId(data.id);\n  }\n\n  useEffect(() => {\n    //驗證身分\n    getjwtvertifyFromServer();\n  }, []); // Modal 顯示狀態\n\n  const [show, setShow] = useState(false); // Modal 開關 function\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true); // 確認有無登入\n\n\n  const checklogin = () => {\n    if (!memberid) {\n      console.log('請先登入會員');\n      handleShow();\n    } else {\n      window.location.href = './cart-form-auction';\n    }\n  };\n\n  const cookies = new Cookies();\n  const [displaycartitems, setDisplayCartItems] = useState([]);\n  const [sqleventid, setSqlEventId] = useState('');\n  /**\n   * 當頁面Load時，讀取Cookie值並更新至cartItems\n   */\n\n  useEffect(() => {\n    let tempArr = [];\n    let tempArrId = [];\n    let cookieProductArr = cookies.get('auc'); // get Cookies\n\n    console.log(cookieProductArr);\n\n    if (cookieProductArr) {\n      for (let i = 0; i < cookieProductArr.length; i++) {\n        let product = cookieProductArr[i];\n        tempArr.push(product);\n        tempArrId.push(product.id.split('-')[0]);\n      }\n    }\n  }, []);\n  const itemsPrice = displaycartitems.reduce((a, c) => a + c.qty * c.eventPrice, 0);\n  const totalPrice = itemsPrice; // 去後台SQL撈資料\n\n  async function getEventIdServer() {\n    // 連接的伺服器資料網址\n    const url = 'http://localhost:6005/auctoin/auction-list'; // 注意資料格式要設定，伺服器才知道是json格式\n\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      })\n    });\n    const response = await fetch(request); // 再把response變成json\n\n    const data = await response.json();\n    let cookieProductArr = cookies.get('auc');\n    console.log(cookieProductArr);\n    var temp = [];\n\n    if (cookieProductArr) {\n      for (let i = 0; i < data.length; i++) {\n        for (let j = 0; j < cookieProductArr.length; j++) {\n          let product = cookieProductArr[j];\n          setSqlEventId(product.id);\n\n          if (data[i].aucId == product.id.split('-')[0]) {\n            let eventtype = product.id.split('-')[1];\n            let eventqty = product.qty;\n            let newDisplay = {\n              id: data[i].id,\n              eventId: data[i].aucId,\n              eventName: data[i].aucName,\n              eventPrice: data[i].aucPriceNow,\n              eventImg: data[i].aucImg,\n              eventType: eventtype,\n              qty: eventqty\n            };\n            temp.push(newDisplay);\n          }\n        }\n      }\n    }\n\n    setDisplayCartItems(temp);\n    console.log(displaycartitems);\n  }\n\n  useEffect(() => {\n    getEventIdServer('', '', '');\n  }, []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [displaycartitems.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-empty\",\n      children: \"\\u60A8\\u7684\\u8CFC\\u7269\\u8ECA\\u662F\\u7A7A\\u7684\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 9\n    }, this), displaycartitems.map(item => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"c-product-r1 d-block d-flex py-5 pl-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-img150\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: `http://localhost:6005/Aucpics/auc/${item.eventImg}`,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-product1detail d-flex flex-column justify-content-between col-4 pl-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"h4\",\n              children: item.eventName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 155,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"c-pid\",\n              children: [\"\\u62CD\\u8CE3\\u7DE8\\u865F # \", item.eventId]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"mt-2 c-countdown\",\n              children: /*#__PURE__*/_jsxDEV(AuctionCountDown, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 160,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 159,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: item.eventType === '' ? 'd-none' : 'mt-2',\n              children: [\"\\u7968\\u7A2E\\uFF1A\", item.eventType]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 162,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-lg-flex\",\n            children: /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"##\",\n              className: \"c-product-a d-flex align-items-center\",\n              children: [/*#__PURE__*/_jsxDEV(FaRegEdit, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 177,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"c-store2 ml-1 mr-4\",\n                children: \"\\u62CD\\u8CE3\\u7D30\\u7BC0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 178,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 173,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-price d-flex flex-column align-items-center col-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-5\",\n            children: \"\\u50F9\\u683C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"NT$ \", item.eventPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-quantity d-flex flex-column align-items-center col-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-5\",\n            children: \"\\u6578\\u91CF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: item.qty\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 188,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-total d-flex flex-column align-items-center col-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-5\",\n            children: \"\\u5C0F\\u8A08\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"NT$ \", item.qty * item.eventPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 11\n      }, this)\n    }, void 0, false)), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-between mt-3 pt-3 pb-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: true,\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"##\",\n          className: \"c-store2 mr-5\",\n          children: \"\\u806F\\u7D61\\u5BA2\\u670D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"##\",\n          className: \"c-store2 d-block mt-2\",\n          children: \"\\u904B\\u8CBB\\uFF06\\u9000\\u8CA8\\u689D\\u6B3E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 205,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"\\u7E3D\\u8A08\\uFF1A\", /*#__PURE__*/_jsxDEV(\"sapn\", {\n            className: \"h4\",\n            children: [\"NT$ \", totalPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 210,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"##\",\n          className: \"c-store2 d-block ml-5 mt-3\",\n          children: \"\\u9078\\u53D6\\u4F60\\u7684\\u6298\\u6263\\u78BC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-checkout pt-4 d-flex justify-content-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(FaLock, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"c-lock ml-1\",\n          children: \"\\u672C\\u8CE3\\u5834\\u4F7F\\u7528\\u7DA0\\u754C\\u79D1\\u6280\\u5B89\\u5168\\u7D50\\u5E33\\u7CFB\\u7D71\\uFF0C\\u4FDD\\u969C\\u60A8\\u7684\\u8CC7\\u5B89\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: displaycartitems.length == 0,\n        onClick: checklogin,\n        className: \"c-checkoutbtn2\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"javascript:void(0)\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u7D50\\u5E33\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      centered: true,\n      show: show,\n      onHide: handleClose,\n      id: \"eventModal\",\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"\\u8ACB\\u767B\\u5165\\u6703\\u54E1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u60A8\\u76EE\\u524D\\u9084\\u672A\\u767B\\u5165\\u6703\\u54E1\\uFF0C\\u8ACB\\u767B\\u5165\\u6703\\u54E1\\u9032\\u884C\\u7D50\\u5E33\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"button\",\n          className: \"e-btn-s e-modal-close\",\n          onClick: handleClose,\n          children: \"\\u95DC\\u9589\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"button\",\n          className: \"e-btn-s e-modal-del\",\n          onClick: () => {\n            window.location.href = './user-login';\n          },\n          children: \"\\u767B\\u5165\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 239,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 140,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BasketEvent, \"5QerqxPKLIV+ydl5V0YUTQWWvnw=\");\n\n_c = BasketEvent;\nexport default BasketEvent;\n\nvar _c;\n\n$RefreshReg$(_c, \"BasketEvent\");","map":{"version":3,"sources":["/Users/Gary 1/Desktop/Code stuff/資策會/專題/大專/artddict-react/src/pages/cart/components/BasketAuction.js"],"names":["React","useState","useEffect","Cookies","AuctionCountDown","Modal","Button","FaRegEdit","FaLock","RiDeleteBinLine","BasketEvent","memberid","setMemberId","getjwtvertifyFromServer","token","localStorage","getItem","response","fetch","method","headers","body","JSON","stringify","data","json","console","log","id","show","setShow","handleClose","handleShow","checklogin","window","location","href","cookies","displaycartitems","setDisplayCartItems","sqleventid","setSqlEventId","tempArr","tempArrId","cookieProductArr","get","i","length","product","push","split","itemsPrice","reduce","a","c","qty","eventPrice","totalPrice","getEventIdServer","url","request","Request","Headers","Accept","temp","j","aucId","eventtype","eventqty","newDisplay","eventId","eventName","aucName","aucPriceNow","eventImg","aucImg","eventType","map","item"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Cookies from 'universal-cookie'\nimport AuctionCountDown from './AuctionCountDown'\nimport { Modal, Button } from 'react-bootstrap'\n\n// icon\nimport { FaRegEdit } from 'react-icons/fa'\nimport { FaLock } from 'react-icons/fa'\nimport { RiDeleteBinLine } from 'react-icons/ri'\n\nfunction BasketEvent() {\n  //假設會員id\n  const [memberid, setMemberId] = useState('')\n\n  //驗證身分\n  async function getjwtvertifyFromServer() {\n    const token = localStorage.getItem('token')\n\n    const response = await fetch(\n      'http://localhost:6005/users/checklogin',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          token,\n        }),\n      }\n    )\n\n    const data = await response.json()\n    console.log(data)\n    setMemberId(data.id)\n  }\n\n  useEffect(() => {\n    //驗證身分\n    getjwtvertifyFromServer()\n  }, [])\n\n  // Modal 顯示狀態\n  const [show, setShow] = useState(false)\n  // Modal 開關 function\n  const handleClose = () => setShow(false)\n  const handleShow = () => setShow(true)\n\n  // 確認有無登入\n  const checklogin = () => {\n    if (!memberid) {\n      console.log('請先登入會員')\n      handleShow()\n    } else {\n      window.location.href = './cart-form-auction'\n    }\n  }\n\n  const cookies = new Cookies()\n  const [displaycartitems, setDisplayCartItems] = useState(\n    []\n  )\n  const [sqleventid, setSqlEventId] = useState('')\n\n  /**\n   * 當頁面Load時，讀取Cookie值並更新至cartItems\n   */\n  useEffect(() => {\n    let tempArr = []\n    let tempArrId = []\n    let cookieProductArr = cookies.get('auc') // get Cookies\n    console.log(cookieProductArr)\n\n    if (cookieProductArr) {\n      for (let i = 0; i < cookieProductArr.length; i++) {\n        let product = cookieProductArr[i]\n        tempArr.push(product)\n        tempArrId.push(product.id.split('-')[0])\n      }\n    }\n  }, [])\n\n  const itemsPrice = displaycartitems.reduce(\n    (a, c) => a + c.qty * c.eventPrice,\n    0\n  )\n  const totalPrice = itemsPrice\n\n  // 去後台SQL撈資料\n  async function getEventIdServer() {\n    // 連接的伺服器資料網址\n    const url = 'http://localhost:6005/auctoin/auction-list'\n\n    // 注意資料格式要設定，伺服器才知道是json格式\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      }),\n    })\n    const response = await fetch(request)\n    // 再把response變成json\n    const data = await response.json()\n\n    let cookieProductArr = cookies.get('auc')\n    console.log(cookieProductArr)\n    var temp = []\n    if (cookieProductArr) {\n      for (let i = 0; i < data.length; i++) {\n        for (let j = 0; j < cookieProductArr.length; j++) {\n          let product = cookieProductArr[j]\n          setSqlEventId(product.id)\n\n          if (data[i].aucId == product.id.split('-')[0]) {\n            let eventtype = product.id.split('-')[1]\n            let eventqty = product.qty\n            let newDisplay = {\n              id: data[i].id,\n              eventId: data[i].aucId,\n              eventName: data[i].aucName,\n              eventPrice: data[i].aucPriceNow,\n              eventImg: data[i].aucImg,\n              eventType: eventtype,\n              qty: eventqty,\n            }\n            temp.push(newDisplay)\n          }\n        }\n      }\n    }\n    setDisplayCartItems(temp)\n    console.log(displaycartitems)\n  }\n\n  useEffect(() => {\n    getEventIdServer('', '', '')\n  }, [])\n\n  return (\n    <div>\n      {displaycartitems.length === 0 && (\n        <div className=\"c-empty\">您的購物車是空的</div>\n      )}\n      {displaycartitems.map((item) => (\n        <>\n          <div className=\"c-product-r1 d-block d-flex py-5 pl-4\">\n            <div className=\"c-img150\">\n              <img\n                src={`http://localhost:6005/Aucpics/auc/${item.eventImg}`}\n                alt=\"\"\n              />\n            </div>\n            <div className=\"c-product1detail d-flex flex-column justify-content-between col-4 pl-4\">\n              <div>\n                <p className=\"h4\">{item.eventName}</p>\n                <p className=\"c-pid\">\n                  拍賣編號 # {item.eventId}\n                </p>\n                <p className=\"mt-2 c-countdown\">\n                  <AuctionCountDown />\n                </p>\n                <p\n                  className={\n                    item.eventType === ''\n                      ? 'd-none'\n                      : 'mt-2'\n                  }\n                >\n                  票種：{item.eventType}\n                </p>\n              </div>\n              <div className=\"d-lg-flex\">\n                <a\n                  href=\"##\"\n                  className=\"c-product-a d-flex align-items-center\"\n                >\n                  <FaRegEdit size={20} />\n                  <p className=\"c-store2 ml-1 mr-4\">\n                    拍賣細節\n                  </p>\n                </a>\n              </div>\n            </div>\n            <div className=\"c-price d-flex flex-column align-items-center col-2\">\n              <p className=\"mb-5\">價格</p>\n              <p>NT$ {item.eventPrice}</p>\n            </div>\n            <div className=\"c-quantity d-flex flex-column align-items-center col-2\">\n              <p className=\"mb-5\">數量</p>\n              <p>{item.qty}</p>\n            </div>\n            <div className=\"c-total d-flex flex-column align-items-center col-2\">\n              <p className=\"mb-5\">小計</p>\n              <p>NT$ {item.qty * item.eventPrice}</p>\n            </div>\n          </div>\n        </>\n      ))}\n\n      <div className=\"d-flex justify-content-between mt-3 pt-3 pb-5\">\n        <div className>\n          <a href=\"##\" className=\"c-store2 mr-5\">\n            聯絡客服\n          </a>\n          <a href=\"##\" className=\"c-store2 d-block mt-2\">\n            運費＆退貨條款\n          </a>\n        </div>\n        <div>\n          <p>\n            總計：\n            <sapn className=\"h4\">NT$ {totalPrice}</sapn>\n          </p>\n          <a\n            href=\"##\"\n            className=\"c-store2 d-block ml-5 mt-3\"\n          >\n            選取你的折扣碼\n          </a>\n        </div>\n      </div>\n      <div className=\"c-checkout pt-4 d-flex justify-content-between\">\n        <div className=\"d-flex align-items-center\">\n          <FaLock size={20} />\n          <p className=\"c-lock ml-1\">\n            本賣場使用綠界科技安全結帳系統，保障您的資安\n          </p>\n        </div>\n        <button\n          disabled={displaycartitems.length == 0}\n          onClick={checklogin}\n          className=\"c-checkoutbtn2\"\n        >\n          <a href=\"javascript:void(0)\">\n            <p>結帳</p>\n          </a>\n        </button>\n      </div>\n      <Modal\n        centered\n        show={show}\n        onHide={handleClose}\n        id=\"eventModal\"\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>請登入會員</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <div>您目前還未登入會員，請登入會員進行結帳</div>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button\n            type=\"button\"\n            className=\"e-btn-s e-modal-close\"\n            onClick={handleClose}\n          >\n            關閉\n          </Button>\n          <Button\n            type=\"button\"\n            className=\"e-btn-s e-modal-del\"\n            onClick={() => {\n              window.location.href = './user-login'\n            }}\n          >\n            登入\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </div>\n  )\n}\n\nexport default BasketEvent\n"]},"metadata":{},"sourceType":"module"}