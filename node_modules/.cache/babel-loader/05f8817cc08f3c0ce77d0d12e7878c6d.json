{"ast":null,"code":"var _jsxFileName = \"/Users/Gary 1/Desktop/Code stuff/\\u8CC7\\u7B56\\u6703/\\u5C08\\u984C/\\u5927\\u5C08/artddict-react/src/pages/user/MsgEdit.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport { withRouter, Link, NavLink } from 'react-router-dom';\nimport { Container } from 'react-bootstrap';\nimport { countries, townships } from './data/address'; // styles\n\nimport './styles/MsgEdit.scss';\nimport './styles/classes.css'; // import Menu from './components/Menu'\n\nimport Logoheader from './components/Logoheader';\nimport Breadcrumb from './components/UserBreadcrumb'; // @material-ui\n\nimport RadioGroup from '@material-ui/core/RadioGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport StyledRadio from './StyledRadio'; // SweetAlert\n\nimport swal from 'sweetalert';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction UserEdit(props) {\n  _s();\n\n  const [country, setCountry] = useState(-1);\n  const [township, setTownship] = useState(-1);\n  const [dataLoading, setDataLoading] = useState(false);\n  const [username, setUsername] = useState('');\n  const [name, setName] = useState('');\n  const [gender, setGender] = useState('');\n  const [mobile, setMobile] = useState('');\n  const [birthday, setBirthday] = useState('');\n  const [address, setAddress] = useState('');\n  const [id, setId] = useState(''); //\n\n  const userid = props.match.params.userid;\n\n  async function getUserFromServer(userid) {\n    // 開啟載入指示\n    setDataLoading(true); // 連接的伺服器資料網址\n\n    const url = `http://localhost:6005/users/${userid}`; // 注意header資料格式要設定，伺服器才知道是json格式\n\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'appliaction/json'\n      })\n    });\n    const response = await fetch(request);\n    const data = await response.json();\n    console.log(`[GET] response = ${data.gender}`);\n    setUsername(data.username);\n    setName(data.name);\n    setGender(data.gender);\n    setMobile(data.mobile);\n    setId(data.id); // setBirthday(data.birthday)\n\n    if (data.birthday != null) {\n      const myDate = new Date(data.birthday); // 顯示時會扣一天所以硬加回來（後面寫入資料庫時則不會被影響）\n\n      const nextDay = new Date(myDate);\n      nextDay.setDate(myDate.getDate() + 1);\n      const js_date = nextDay.toISOString().substring(0, 10);\n      console.log(`js_date=${js_date}`);\n      setBirthday(js_date);\n    } // setBirthday(data.birthday)\n    // 拆解得到的addres => country, township, addresses\n\n\n    const raw_address = data.address; // const split_address = raw_address.split('_')\n\n    console.log(`raw_address = ${raw_address}`);\n\n    if (data.address != null) {\n      const split_address = raw_address.split('_');\n      console.log(`country = ${split_address[0]}, township = ${split_address[1]}`);\n      setCountry(split_address[0]);\n      setTownship(split_address[1]);\n      setAddress(split_address[2]);\n    }\n  }\n\n  async function updateUserToSever() {\n    // 開啟載入指示\n    setDataLoading(true); // 印出市: countries[country]\n    // 印出區: townships[country][township]\n\n    const whole_address = `${country}_${township}_${address}`; // 準備好送給node的json資料\n\n    const newData = {\n      username,\n      name,\n      gender,\n      mobile,\n      birthday,\n      country,\n      township,\n      address: whole_address // address : _ + _ + _\n\n    }; // 連接的伺服器資料網址\n\n    const url = `http://localhost:6005/users/${userid}`; // 注意資料格式要設定，伺服器才知道是json格式\n\n    const request = new Request(url, {\n      method: 'PUT',\n      body: JSON.stringify(newData),\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      })\n    });\n    console.log(`data from react = ${JSON.stringify(newData)}`);\n    const response = await fetch(request);\n    const data = await response.json();\n    console.log('伺服器回傳的json資料', data); // 要等驗証過，再設定資料(簡單的直接設定)\n    //直接在一段x秒關掉指示器\n\n    setTimeout(() => {\n      setDataLoading(false);\n      swal({\n        text: '修改成功！！！',\n        icon: 'success',\n        button: false,\n        timer: 3000\n      });\n    }, 1000);\n  } // 一開始就會開始載入資料\n\n\n  useEffect(() => {\n    getUserFromServer(userid);\n  }, []); // 每次users資料有變動就會X秒後關掉載入指示\n\n  useEffect(() => {\n    setTimeout(() => {\n      setDataLoading(false);\n    }, 1000);\n  }, [userid]);\n\n  async function logoutToSever() {\n    // 連接的伺服器資料網址\n    localStorage.removeItem('token');\n    const url = 'http://localhost:6005/users/logout'; // 注意資料格式要設定，伺服器才知道是json格式\n\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      })\n    }); // 要等驗証過，再設定資料(簡單的直接設定)\n\n    swal({\n      text: '登出成功！',\n      icon: 'success',\n      button: false,\n      timer: 3000\n    });\n    const response = await fetch(request);\n    const data = await response.json();\n  }\n\n  const loading = /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"u-body\",\n      children: [/*#__PURE__*/_jsxDEV(Logoheader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 185,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-center\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"spinner-border\",\n          role: \"status\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"sr-only\",\n            children: \"Loading...\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 186,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n\n  const display = /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"u-body\",\n      children: [/*#__PURE__*/_jsxDEV(Logoheader, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 198,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"u-breadcrumb\",\n        children: /*#__PURE__*/_jsxDEV(Breadcrumb, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 200,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"tab-bar\",\n        children: [/*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: `/user-msgedit/${userid}`,\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u4FEE\\u6539\\u8CC7\\u6599\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: `/user-orderpro/${userid}`,\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u8A02\\u55AE\\u67E5\\u8A62\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: `/user-coupon/${userid}`,\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u6211\\u7684\\u512A\\u60E0\\u5238\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 220,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: `/user-ticket/${userid}`,\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u6211\\u7684\\u7968\\u5238\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: `/user-myfav/${userid}`,\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u6211\\u7684\\u6536\\u85CF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: `/user-auction/${userid}`,\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u7AF6\\u6A19\\u67E5\\u8A62\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(NavLink, {\n          activeClassName: \"activenav\",\n          className: 'tab',\n          to: \"/user-login\",\n          onClick: () => {\n            logoutToSever();\n          },\n          style: {\n            textDecoration: 'none'\n          },\n          children: \"\\u767B\\u51FA\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Container, {\n        fluid: true,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"u-row d-flex justify-content-around\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"u-usertitleLeft1\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: `/user-msgedit/${userid}`,\n              children: \"\\u6703\\u54E1\\u8CC7\\u6599\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"u-usertitleRight1\",\n            children: /*#__PURE__*/_jsxDEV(Link, {\n              to: `/user-pwdedit/${userid}`,\n              children: \"\\u4FEE\\u6539\\u5BC6\\u78BC\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 272,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Container, {\n          className: \"u-userData\",\n          children: /*#__PURE__*/_jsxDEV(\"form\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group u-form1 cn-font\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                for: \"username\",\n                children: \"\\u5E33\\u865F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 280,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: username,\n                type: \"email\",\n                className: \"form-control\",\n                onChange: event => {\n                  setUsername(event.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 281,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 279,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group u-form1 cn-font\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                for: \"name\",\n                children: \"\\u59D3\\u540D\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 291,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: name,\n                type: \"text\",\n                className: \"form-control\",\n                onChange: event => {\n                  setName(event.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 292,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group  u-gender-ckb cn-font\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                for: \"gender\",\n                children: \"\\u6027\\u5225\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 303,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(FormControl, {\n                component: \"fieldset\",\n                children: /*#__PURE__*/_jsxDEV(RadioGroup, {\n                  row: true,\n                  defaultValue: gender,\n                  \"aria-label\": \"gender\",\n                  name: \"customized-radios\",\n                  onChange: event => {\n                    setGender(event.target.value);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(FormControlLabel, {\n                    value: \"male\",\n                    control: /*#__PURE__*/_jsxDEV(StyledRadio, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 317,\n                      columnNumber: 32\n                    }, this),\n                    label: \"\\u7537\",\n                    onChange: event => {\n                      setGender(event.target.value);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n                    value: \"female\",\n                    control: /*#__PURE__*/_jsxDEV(StyledRadio, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 325,\n                      columnNumber: 32\n                    }, this),\n                    label: \"\\u5973\",\n                    onChange: event => {\n                      setGender(event.target.value);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 323,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n                    value: \"other\",\n                    control: /*#__PURE__*/_jsxDEV(StyledRadio, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 333,\n                      columnNumber: 32\n                    }, this),\n                    label: \"\\u5176\\u4ED6\",\n                    onChange: event => {\n                      setGender(event.target.value);\n                    }\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 331,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 306,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 305,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 302,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group u-form1 cn-font\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                for: \"tel\",\n                children: \"\\u624B\\u6A5F\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: mobile,\n                type: \"tel\",\n                className: \"form-control\",\n                id: \"tel\",\n                onChange: event => {\n                  setMobile(event.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 342,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group u-form1 cn-font\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                for: \"birthday\",\n                children: \"\\u751F\\u65E5\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 356,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: birthday,\n                type: \"date\",\n                className: \"form-control\",\n                id: \"birthday\",\n                onChange: event => {\n                  setBirthday(event.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 357,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"form-group u-form1 cn-font\",\n              children: [/*#__PURE__*/_jsxDEV(\"label\", {\n                for: \"address\",\n                children: \"\\u4F4F\\u5740\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 369,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"u-Select\",\n                children: /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"\",\n                  id: \"\",\n                  className: \"u-sel1\",\n                  value: country,\n                  onChange: e => {\n                    setCountry(+e.target.value);\n                    setTownship(-1);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    children: \"\\u8ACB\\u9078\\u64C7\\u7E23\\u5E02\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 382,\n                    columnNumber: 21\n                  }, this), countries.map((value, index) => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: index,\n                    children: value\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 384,\n                    columnNumber: 23\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 371,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"u-Select\",\n                children: /*#__PURE__*/_jsxDEV(\"select\", {\n                  name: \"\",\n                  id: \"\",\n                  className: \"u-sel2 mt-5\",\n                  value: township,\n                  onChange: e => {\n                    setTownship(+e.target.value);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"options\", {\n                    children: \"\\u8ACB\\u9078\\u64C7\\u5340\\u57DF\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 401,\n                    columnNumber: 21\n                  }, this), country > -1 && townships[country].map((value, index) => /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: index,\n                    children: value\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 405,\n                    columnNumber: 27\n                  }, this))]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 392,\n                  columnNumber: 19\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 391,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                value: address,\n                type: \"text\",\n                className: \"form-control mt-5\",\n                id: \"address\",\n                onChange: event => {\n                  setAddress(event.target.value);\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 412,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"u-editBtn\",\n              children: /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn btn-outline-dark editBtn\",\n                onClick: () => {\n                  updateUserToSever();\n                },\n                children: \"\\u4FEE\\u6539\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 424,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 423,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 278,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 264,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n  /*\n  檢查登入狀態以確認router不回傳頁面內容\n   - getjwtvertifyFromServer 呼叫JWT檢查登入狀態之API\n   \b- 若檢查登入\n      成功, 顯示頁面內容\n      失敗, 重新導向登入頁面\n   - 使用waitAsync包覆檢查函式\n   - 判斷waitAsync決定render\n  */\n\n\n  async function getjwtvertifyFromServer() {\n    const token = localStorage.getItem('token');\n    const response = await fetch('http://localhost:6005/users/checklogin', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        token\n      })\n    });\n    const data = await response.json();\n    console.log('check login response = ', data);\n    console.log('data.id = ', data.id);\n    console.log('userid = ', userid);\n\n    if (data.id == userid) {\n      var stat = true;\n    } else {\n      var stat = false;\n    }\n\n    console.log('stat = ', stat);\n    return stat;\n  } // async needs to be waited in another funciton\n\n\n  const waitAsync = async () => {\n    const isLoggedin = await getjwtvertifyFromServer();\n\n    if (!isLoggedin) {\n      console.log('no display!');\n      swal({\n        title: '登入驗證失敗',\n        text: '您的登入驗證已過期或者尚未登入, 請重新登入\\n正在將您導向登入頁面 ...',\n        button: false,\n        timer: 2000\n      });\n      setTimeout(() => {\n        window.location.replace(`../user-login/`);\n      }, 500); // throw new Error('Oopsie woopsie')\n    }\n  };\n\n  if (waitAsync()) {\n    // setDataLoading(true)\n    console.log('display!');\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: dataLoading ? loading : display\n    }, void 0, false);\n  }\n}\n\n_s(UserEdit, \"3XjMyhMASlfGrYgvNxJX8tnQwEQ=\");\n\n_c = UserEdit;\nexport default _c2 = withRouter(UserEdit);\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"UserEdit\");\n$RefreshReg$(_c2, \"%default%\");","map":{"version":3,"sources":["/Users/Gary 1/Desktop/Code stuff/資策會/專題/大專/artddict-react/src/pages/user/MsgEdit.js"],"names":["React","useState","useEffect","withRouter","Link","NavLink","Container","countries","townships","Logoheader","Breadcrumb","RadioGroup","FormControlLabel","FormControl","StyledRadio","swal","axios","UserEdit","props","country","setCountry","township","setTownship","dataLoading","setDataLoading","username","setUsername","name","setName","gender","setGender","mobile","setMobile","birthday","setBirthday","address","setAddress","id","setId","userid","match","params","getUserFromServer","url","request","Request","method","headers","Headers","Accept","response","fetch","data","json","console","log","myDate","Date","nextDay","setDate","getDate","js_date","toISOString","substring","raw_address","split_address","split","updateUserToSever","whole_address","newData","body","JSON","stringify","setTimeout","text","icon","button","timer","logoutToSever","localStorage","removeItem","loading","display","textDecoration","event","target","value","e","map","index","getjwtvertifyFromServer","token","getItem","stat","waitAsync","isLoggedin","title","window","location","replace"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport { withRouter, Link, NavLink } from 'react-router-dom'\nimport { Container } from 'react-bootstrap'\nimport { countries, townships } from './data/address'\n// styles\nimport './styles/MsgEdit.scss'\nimport './styles/classes.css'\n// import Menu from './components/Menu'\nimport Logoheader from './components/Logoheader'\nimport Breadcrumb from './components/UserBreadcrumb'\n// @material-ui\nimport RadioGroup from '@material-ui/core/RadioGroup'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport FormControl from '@material-ui/core/FormControl'\nimport StyledRadio from './StyledRadio'\n// SweetAlert\nimport swal from 'sweetalert'\nimport axios from 'axios'\n\nfunction UserEdit(props) {\n  const [country, setCountry] = useState(-1)\n  const [township, setTownship] = useState(-1)\n  const [dataLoading, setDataLoading] = useState(false)\n  const [username, setUsername] = useState('')\n  const [name, setName] = useState('')\n  const [gender, setGender] = useState('')\n  const [mobile, setMobile] = useState('')\n  const [birthday, setBirthday] = useState('')\n  const [address, setAddress] = useState('')\n  const [id, setId] = useState('')\n\n  //\n  const userid = props.match.params.userid\n\n  async function getUserFromServer(userid) {\n    // 開啟載入指示\n    setDataLoading(true)\n\n    // 連接的伺服器資料網址\n    const url = `http://localhost:6005/users/${userid}`\n\n    // 注意header資料格式要設定，伺服器才知道是json格式\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'appliaction/json',\n      }),\n    })\n\n    const response = await fetch(request)\n    const data = await response.json()\n    console.log(`[GET] response = ${data.gender}`)\n\n    setUsername(data.username)\n    setName(data.name)\n    setGender(data.gender)\n    setMobile(data.mobile)\n    setId(data.id)\n    // setBirthday(data.birthday)\n    if (data.birthday != null) {\n      const myDate = new Date(data.birthday)\n      // 顯示時會扣一天所以硬加回來（後面寫入資料庫時則不會被影響）\n      const nextDay = new Date(myDate)\n      nextDay.setDate(myDate.getDate() + 1)\n      const js_date = nextDay.toISOString().substring(0, 10)\n      console.log(`js_date=${js_date}`)\n      setBirthday(js_date)\n    }\n    // setBirthday(data.birthday)\n\n    // 拆解得到的addres => country, township, addresses\n    const raw_address = data.address\n    // const split_address = raw_address.split('_')\n    console.log(`raw_address = ${raw_address}`)\n    if (data.address != null) {\n      const split_address = raw_address.split('_')\n\n      console.log(\n        `country = ${split_address[0]}, township = ${split_address[1]}`\n      )\n\n      setCountry(split_address[0])\n      setTownship(split_address[1])\n      setAddress(split_address[2])\n    }\n  }\n\n  async function updateUserToSever() {\n    // 開啟載入指示\n    setDataLoading(true)\n    // 印出市: countries[country]\n    // 印出區: townships[country][township]\n    const whole_address = `${country}_${township}_${address}`\n    // 準備好送給node的json資料\n    const newData = {\n      username,\n      name,\n      gender,\n      mobile,\n      birthday,\n      country,\n      township,\n      address: whole_address,\n      // address : _ + _ + _\n    }\n\n    // 連接的伺服器資料網址\n    const url = `http://localhost:6005/users/${userid}`\n\n    // 注意資料格式要設定，伺服器才知道是json格式\n    const request = new Request(url, {\n      method: 'PUT',\n      body: JSON.stringify(newData),\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      }),\n    })\n\n    console.log(\n      `data from react = ${JSON.stringify(newData)}`\n    )\n\n    const response = await fetch(request)\n    const data = await response.json()\n\n    console.log('伺服器回傳的json資料', data)\n    // 要等驗証過，再設定資料(簡單的直接設定)\n\n    //直接在一段x秒關掉指示器\n    setTimeout(() => {\n      setDataLoading(false)\n      swal({\n        text: '修改成功！！！',\n        icon: 'success',\n        button: false,\n        timer: 3000,\n      })\n    }, 1000)\n  }\n\n  // 一開始就會開始載入資料\n  useEffect(() => {\n    getUserFromServer(userid)\n  }, [])\n\n  // 每次users資料有變動就會X秒後關掉載入指示\n  useEffect(() => {\n    setTimeout(() => {\n      setDataLoading(false)\n    }, 1000)\n  }, [userid])\n\n  async function logoutToSever() {\n    // 連接的伺服器資料網址\n    localStorage.removeItem('token')\n    const url = 'http://localhost:6005/users/logout'\n\n    // 注意資料格式要設定，伺服器才知道是json格式\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      }),\n    })\n\n    // 要等驗証過，再設定資料(簡單的直接設定)\n\n    swal({\n      text: '登出成功！',\n      icon: 'success',\n      button: false,\n      timer: 3000,\n    })\n\n    const response = await fetch(request)\n    const data = await response.json()\n  }\n\n  const loading = (\n    <>\n      <div className=\"u-body\">\n        <Logoheader />\n        <div className=\"d-flex justify-content-center\">\n          <div className=\"spinner-border\" role=\"status\">\n            <span className=\"sr-only\">Loading...</span>\n          </div>\n        </div>\n      </div>\n    </>\n  )\n\n  const display = (\n    <>\n      <div className=\"u-body\">\n        <Logoheader />\n        <div className=\"u-breadcrumb\">\n          <Breadcrumb />\n        </div>\n        <div className=\"tab-bar\">\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to={`/user-msgedit/${userid}`}\n            style={{ textDecoration: 'none' }}\n          >\n            修改資料\n          </NavLink>\n\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to={`/user-orderpro/${userid}`}\n            style={{ textDecoration: 'none' }}\n          >\n            訂單查詢\n          </NavLink>\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to={`/user-coupon/${userid}`}\n            style={{ textDecoration: 'none' }}\n          >\n            我的優惠券\n          </NavLink>\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to={`/user-ticket/${userid}`}\n            style={{ textDecoration: 'none' }}\n          >\n            我的票券\n          </NavLink>\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to={`/user-myfav/${userid}`}\n            style={{ textDecoration: 'none' }}\n          >\n            我的收藏\n          </NavLink>\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to={`/user-auction/${userid}`}\n            style={{ textDecoration: 'none' }}\n          >\n            競標查詢\n          </NavLink>\n          <NavLink\n            activeClassName=\"activenav\"\n            className={'tab'}\n            to=\"/user-login\"\n            onClick={() => {\n              logoutToSever()\n            }}\n            style={{ textDecoration: 'none' }}\n          >\n            登出\n          </NavLink>\n        </div>\n        <Container fluid>\n          <div className=\"u-row d-flex justify-content-around\">\n            <div className=\"u-usertitleLeft1\">\n              <Link to={`/user-msgedit/${userid}`}>\n                會員資料\n              </Link>\n            </div>\n            <div className=\"u-usertitleRight1\">\n              <Link to={`/user-pwdedit/${userid}`}>\n                修改密碼\n              </Link>\n            </div>\n          </div>\n          <Container className=\"u-userData\">\n            <form>\n              <div className=\"form-group u-form1 cn-font\">\n                <label for=\"username\">帳號</label>\n                <input\n                  value={username}\n                  type=\"email\"\n                  className=\"form-control\"\n                  onChange={(event) => {\n                    setUsername(event.target.value)\n                  }}\n                />\n              </div>\n              <div className=\"form-group u-form1 cn-font\">\n                <label for=\"name\">姓名</label>\n                <input\n                  value={name}\n                  type=\"text\"\n                  className=\"form-control\"\n                  onChange={(event) => {\n                    setName(event.target.value)\n                  }}\n                />\n              </div>\n\n              <div className=\"form-group  u-gender-ckb cn-font\">\n                <label for=\"gender\">性別</label>\n                <br />\n                <FormControl component=\"fieldset\">\n                  <RadioGroup\n                    row\n                    defaultValue={gender}\n                    aria-label=\"gender\"\n                    name=\"customized-radios\"\n                    onChange={(event) => {\n                      setGender(event.target.value)\n                    }}\n                  >\n                    <FormControlLabel\n                      value=\"male\"\n                      control={<StyledRadio />}\n                      label=\"男\"\n                      onChange={(event) => {\n                        setGender(event.target.value)\n                      }}\n                    />\n                    <FormControlLabel\n                      value=\"female\"\n                      control={<StyledRadio />}\n                      label=\"女\"\n                      onChange={(event) => {\n                        setGender(event.target.value)\n                      }}\n                    />\n                    <FormControlLabel\n                      value=\"other\"\n                      control={<StyledRadio />}\n                      label=\"其他\"\n                      onChange={(event) => {\n                        setGender(event.target.value)\n                      }}\n                    />\n                  </RadioGroup>\n                </FormControl>\n              </div>\n              <div className=\"form-group u-form1 cn-font\">\n                <label for=\"tel\">手機</label>\n                <input\n                  value={mobile}\n                  type=\"tel\"\n                  className=\"form-control\"\n                  id=\"tel\"\n                  onChange={(event) => {\n                    setMobile(event.target.value)\n                  }}\n                />\n              </div>\n\n              <div className=\"form-group u-form1 cn-font\">\n                <label for=\"birthday\">生日</label>\n                <input\n                  value={birthday}\n                  type=\"date\"\n                  className=\"form-control\"\n                  id=\"birthday\"\n                  onChange={(event) => {\n                    setBirthday(event.target.value)\n                  }}\n                />\n              </div>\n\n              <div className=\"form-group u-form1 cn-font\">\n                <label for=\"address\">住址</label>\n                <br />\n                <div className=\"u-Select\">\n                  <select\n                    name=\"\"\n                    id=\"\"\n                    className=\"u-sel1\"\n                    value={country}\n                    onChange={(e) => {\n                      setCountry(+e.target.value)\n                      setTownship(-1)\n                    }}\n                  >\n                    <option>請選擇縣市</option>\n                    {countries.map((value, index) => (\n                      <option key={index} value={index}>\n                        {value}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n\n                <div className=\"u-Select\">\n                  <select\n                    name=\"\"\n                    id=\"\"\n                    className=\"u-sel2 mt-5\"\n                    value={township}\n                    onChange={(e) => {\n                      setTownship(+e.target.value)\n                    }}\n                  >\n                    <options>請選擇區域</options>\n                    {country > -1 &&\n                      townships[country].map(\n                        (value, index) => (\n                          <option key={index} value={index}>\n                            {value}\n                          </option>\n                        )\n                      )}\n                  </select>\n                </div>\n                <input\n                  value={address}\n                  type=\"text\"\n                  className=\"form-control mt-5\"\n                  id=\"address\"\n                  onChange={(event) => {\n                    setAddress(event.target.value)\n                  }}\n                />\n              </div>\n\n              <div className=\"u-editBtn\">\n                <button\n                  className=\"btn btn-outline-dark editBtn\"\n                  onClick={() => {\n                    updateUserToSever()\n                  }}\n                >\n                  修改\n                </button>\n              </div>\n            </form>\n          </Container>\n        </Container>\n      </div>\n    </>\n  )\n\n  /*\n  檢查登入狀態以確認router不回傳頁面內容\n   - getjwtvertifyFromServer 呼叫JWT檢查登入狀態之API\n   \b- 若檢查登入\n      成功, 顯示頁面內容\n      失敗, 重新導向登入頁面\n   - 使用waitAsync包覆檢查函式\n   - 判斷waitAsync決定render\n  */\n  async function getjwtvertifyFromServer() {\n    const token = localStorage.getItem('token')\n\n    const response = await fetch(\n      'http://localhost:6005/users/checklogin',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          token,\n        }),\n      }\n    )\n\n    const data = await response.json()\n    console.log('check login response = ', data)\n    console.log('data.id = ', data.id)\n    console.log('userid = ', userid)\n    if (data.id == userid) {\n      var stat = true\n    } else {\n      var stat = false\n    }\n    console.log('stat = ', stat)\n    return stat\n  }\n\n  // async needs to be waited in another funciton\n  const waitAsync = async () => {\n    const isLoggedin = await getjwtvertifyFromServer()\n\n    if (!isLoggedin) {\n      console.log('no display!')\n      swal({\n        title: '登入驗證失敗',\n        text: '您的登入驗證已過期或者尚未登入, 請重新登入\\n正在將您導向登入頁面 ...',\n        button: false,\n        timer: 2000,\n      })\n      setTimeout(() => {\n        window.location.replace(`../user-login/`)\n      }, 500)\n      // throw new Error('Oopsie woopsie')\n    }\n  }\n\n  if (waitAsync()) {\n    // setDataLoading(true)\n    console.log('display!')\n    return <>{dataLoading ? loading : display}</>\n  }\n}\nexport default withRouter(UserEdit)\n"]},"metadata":{},"sourceType":"module"}