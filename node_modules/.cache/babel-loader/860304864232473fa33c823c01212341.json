{"ast":null,"code":"var _jsxFileName = \"/Users/Gary 1/Desktop/Code stuff/\\u8CC7\\u7B56\\u6703/\\u5C08\\u984C/\\u5927\\u5C08/artddict-react/src/pages/cart/components/BasketProduct.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport Cookies from 'universal-cookie';\nimport { Modal, Button } from 'react-bootstrap'; // icon\n\nimport { FaRegEdit } from 'react-icons/fa';\nimport { FaLock } from 'react-icons/fa';\nimport { RiDeleteBinLine } from 'react-icons/ri';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nfunction BasketEvent() {\n  _s();\n\n  //假設會員id\n  const [memberid, setMemberId] = useState(''); //驗證身分\n\n  async function getjwtvertifyFromServer() {\n    const token = localStorage.getItem('token');\n    const response = await fetch('http://localhost:6005/users/checklogin', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        token\n      })\n    });\n    const data = await response.json();\n    console.log(data);\n    setMemberId(data.id);\n  }\n\n  useEffect(() => {\n    //驗證身分\n    getjwtvertifyFromServer();\n  }, []); // Modal 顯示狀態\n\n  const [show, setShow] = useState(false); // Modal 開關 function\n\n  const handleClose = () => setShow(false);\n\n  const handleShow = () => setShow(true); // 確認有無登入\n\n\n  const checklogin = () => {\n    if (!memberid) {\n      console.log('請先登入會員');\n      handleShow();\n    } else {\n      window.location.href = './cart-form-product';\n    }\n  };\n\n  const cookies = new Cookies();\n  const [displaycartitems, setDisplayCartItems] = useState([]);\n  const [sqleventid, setSqlEventId] = useState('');\n  /**\n   * 當頁面Load時，讀取Cookie值並更新至cartItems\n   */\n\n  useEffect(() => {\n    let tempArr = [];\n    let tempArrId = [];\n    let cookieProductArr = cookies.get('product'); // get Cookies\n\n    if (cookieProductArr) {\n      for (let i = 0; i < cookieProductArr.length; i++) {\n        let product = cookieProductArr[i];\n        tempArr.push(product);\n        tempArrId.push(product.id.split('-')[0]);\n      }\n    }\n  }, []);\n  const itemsPrice = displaycartitems.reduce((a, c) => a + c.qty * c.eventPrice, 0);\n  const totalPrice = itemsPrice; // 去後台SQL撈資料\n\n  async function getEventIdServer() {\n    // 連接的伺服器資料網址\n    const url = 'http://localhost:6005/product/product-list'; // 注意資料格式要設定，伺服器才知道是json格式\n\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      })\n    });\n    const response = await fetch(request); // 再把response變成json\n\n    const data = await response.json();\n    let cookieProductArr = cookies.get('product');\n    var temp = [];\n\n    if (cookieProductArr) {\n      for (let i = 0; i < data.length; i++) {\n        for (let j = 0; j < cookieProductArr.length; j++) {\n          let product = cookieProductArr[j];\n          setSqlEventId(product.id);\n\n          if (data[i].proId == product.id.split('-')[0]) {\n            let eventtype = product.id.split('-')[1];\n            let eventqty = product.qty;\n            let proImg = data[i].proImg.replace(/[\\[\\]\"]+/g, '');\n            let newDisplay = {\n              id: data[i].id,\n              eventId: data[i].proId,\n              eventName: data[i].proName,\n              eventPrice: data[i].proPrice,\n              eventImg: proImg,\n              eventType: eventtype,\n              qty: eventqty\n            };\n            temp.push(newDisplay);\n          }\n        }\n      }\n    }\n\n    setDisplayCartItems(temp);\n  }\n\n  useEffect(() => {\n    getEventIdServer('', '', '');\n  }, []);\n  /**\n   * 更新 event Cookie\n   *\n   * @param {Object} event 欲改變的目標 event.\n   * @param {number} quantityNum 欲更新event.qty到的數字.\n   * @param {string} type 根據不同type，event.qty 更新方法不同\n   *\n   *\n   */\n\n  const onCookie = (eventid, quantityNum, type) => {\n    console.log(eventid);\n    let cookieEventId = eventid + '-' + type;\n    let updateCookie = [];\n    let cookieEvent = cookies.get('product'); // 取得 product cookie\n\n    if (cookieEvent) {\n      // 如果有已存在的 event cookie\n      // 查看cookie裡面的 event id\n      const idSet = new Set();\n\n      for (let i in cookieEvent) {\n        idSet.add(cookieEvent[i].id);\n      } // event 在 event cookie 中\n\n\n      if (idSet.has(cookieEventId)) {\n        for (let i in cookieEvent) {\n          if (cookieEvent[i].id == cookieEventId) {\n            // 如果event是從Input,數量直接變成新數字\n            cookieEvent[i].qty = quantityNum;\n          }\n        }\n      } else {\n        // 如果被改變的event 不在 event cookie 中\n        // 初始數量為1\n        let eventjson = {};\n        eventjson.id = cookieEventId;\n        eventjson.qty = quantityNum;\n        cookieEvent.push(eventjson);\n      } // 如果被改變後的event數量>0，加入在cookie 中\n\n\n      for (let i in cookieEvent) {\n        if (cookieEvent[i].qty > 0) {\n          updateCookie.push(cookieEvent[i]);\n        }\n      }\n    } else {\n      // 如果沒有已存在的 event cookie\n      // 初始數量為1\n      let eventjson = {};\n      eventjson.id = cookieEventId;\n      eventjson.qty = quantityNum;\n      updateCookie.push(eventjson);\n    }\n\n    cookies.set('product', updateCookie, {\n      path: '/'\n    }); //更新Cookie\n  };\n  /**\n   * 更新購物車數量\n   *\n   * @param {Object} event 欲改變的目標 event\n   * @param {number} quantityNum event.qty到的數字.\n   *\n   */\n\n\n  const onCartNumChange = (eventid, quantityNum, type) => {\n    const exist = displaycartitems.find(x => x.eventId === eventid);\n    console.log(displaycartitems);\n    onCookie(eventid, quantityNum, type);\n\n    if (quantityNum <= 0) {\n      setDisplayCartItems(displaycartitems.filter(x => x.eventId !== eventid));\n    } else {\n      setDisplayCartItems(displaycartitems.map(x => x.eventId === eventid ? { ...exist,\n        qty: Number(quantityNum)\n      } : x));\n    }\n  };\n  /**\n   * 移出購物車\n   *\n   * @param {Object} event 欲改變的目標 event.\n   *\n   */\n\n\n  const onDelete = (eventid, quantityNum, type) => {\n    onCookie(eventid, 0, type);\n    const exist = displaycartitems.find(x => x.eventId + '-' + x.eventType === eventid + '-' + type);\n\n    if (exist.qty >= 1) {\n      setDisplayCartItems(displaycartitems.filter(x => x.eventId + '-' + x.eventType !== eventid + '-' + type));\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [displaycartitems.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-empty\",\n      children: \"\\u60A8\\u7684\\u8CFC\\u7269\\u8ECA\\u662F\\u7A7A\\u7684\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 9\n    }, this), displaycartitems.map(item => /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"c-product-r1 d-block d-flex py-5 pl-4\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-img150\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: `http://localhost:6005/productpics/${item.eventImg}`,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-product1detail d-flex flex-column justify-content-between col-4 pl-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"h4\",\n              children: item.eventName\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 265,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"c-pid\",\n              children: [\"\\u5546\\u54C1\\u7DE8\\u865F # \", item.eventId]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 266,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              className: item.eventType === '' ? 'd-none' : 'mt-2',\n              children: [\"\\u5C3A\\u5BF8\\uFF1A\", item.eventType]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-lg-flex\",\n            children: [/*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"##\",\n              className: \"c-product-a d-flex align-items-center\",\n              children: [/*#__PURE__*/_jsxDEV(FaRegEdit, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 285,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"c-store2 ml-1 mr-4\",\n                children: \"\\u5546\\u54C1\\u7D30\\u7BC0\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 286,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 281,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n              href: \"##\",\n              className: \"c-product-a d-flex align-items-center\",\n              children: [/*#__PURE__*/_jsxDEV(RiDeleteBinLine, {\n                size: 20\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 294,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                onClick: () => onDelete(item.eventId, 0, item.eventType),\n                className: \"c-store2 ml-1 mr-4\",\n                children: \"\\u79FB\\u9664\\u5546\\u54C1\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 295,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 290,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-price d-flex flex-column align-items-center col-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-5\",\n            children: \"\\u50F9\\u683C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"NT$ \", item.eventPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 312,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-quantity d-flex flex-column align-items-center col-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-3 pb-3\",\n            children: \"\\u6578\\u91CF\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 315,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"c-qbox\",\n            children: /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"number\",\n              value: item.qty,\n              onChange: evt => {\n                onCartNumChange(item.eventId, evt.target.value, item.eventType);\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 317,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"c-total d-flex flex-column align-items-center col-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"mb-5\",\n            children: \"\\u5C0F\\u8A08\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 331,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"NT$ \", item.qty * item.eventPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 332,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 11\n      }, this)\n    }, void 0, false)), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-flex justify-content-between mt-3 pt-3 pb-5\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: true,\n        children: [/*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"##\",\n          className: \"c-store2 mr-5\",\n          children: \"\\u806F\\u7D61\\u5BA2\\u670D\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"##\",\n          className: \"c-store2 d-block mt-2\",\n          children: \"\\u904B\\u8CBB\\uFF06\\u9000\\u8CA8\\u689D\\u6B3E\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 339,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"\\u7E3D\\u8A08\\uFF1A\", /*#__PURE__*/_jsxDEV(\"sapn\", {\n            className: \"h4\",\n            children: [\"NT$ \", totalPrice]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 350,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 348,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"##\",\n          className: \"c-store2 d-block ml-5 mt-3\",\n          children: \"\\u9078\\u53D6\\u4F60\\u7684\\u6298\\u6263\\u78BC\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 352,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 347,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 338,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-checkout pt-4 d-flex justify-content-between\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex align-items-center\",\n        children: [/*#__PURE__*/_jsxDEV(FaLock, {\n          size: 20\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 362,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"c-lock ml-1\",\n          children: \"\\u672C\\u8CE3\\u5834\\u4F7F\\u7528\\u7DA0\\u754C\\u79D1\\u6280\\u5B89\\u5168\\u7D50\\u5E33\\u7CFB\\u7D71\\uFF0C\\u4FDD\\u969C\\u60A8\\u7684\\u8CC7\\u5B89\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        disabled: displaycartitems.length == 0,\n        onClick: checklogin,\n        className: \"c-checkoutbtn2\",\n        children: /*#__PURE__*/_jsxDEV(\"a\", {\n          href: \"javascript:void(0)\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"\\u7D50\\u5E33\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 373,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 372,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 360,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Modal, {\n      centered: true,\n      show: show,\n      onHide: handleClose,\n      id: \"eventModal\",\n      children: [/*#__PURE__*/_jsxDEV(Modal.Header, {\n        closeButton: true,\n        children: /*#__PURE__*/_jsxDEV(Modal.Title, {\n          children: \"\\u8ACB\\u767B\\u5165\\u6703\\u54E1\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 384,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 383,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Body, {\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          children: \"\\u60A8\\u76EE\\u524D\\u9084\\u672A\\u767B\\u5165\\u6703\\u54E1\\uFF0C\\u8ACB\\u767B\\u5165\\u6703\\u54E1\\u9032\\u884C\\u7D50\\u5E33\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 387,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 386,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal.Footer, {\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          type: \"button\",\n          className: \"e-btn-s e-modal-close\",\n          onClick: handleClose,\n          children: \"\\u95DC\\u9589\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 390,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          type: \"button\",\n          className: \"e-btn-s e-modal-del\",\n          onClick: () => {\n            window.location.href = './user-login';\n          },\n          children: \"\\u767B\\u5165\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 397,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 389,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 377,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 250,\n    columnNumber: 5\n  }, this);\n}\n\n_s(BasketEvent, \"5QerqxPKLIV+ydl5V0YUTQWWvnw=\");\n\n_c = BasketEvent;\nexport default BasketEvent;\n\nvar _c;\n\n$RefreshReg$(_c, \"BasketEvent\");","map":{"version":3,"sources":["/Users/Gary 1/Desktop/Code stuff/資策會/專題/大專/artddict-react/src/pages/cart/components/BasketProduct.js"],"names":["React","useState","useEffect","Cookies","Modal","Button","FaRegEdit","FaLock","RiDeleteBinLine","BasketEvent","memberid","setMemberId","getjwtvertifyFromServer","token","localStorage","getItem","response","fetch","method","headers","body","JSON","stringify","data","json","console","log","id","show","setShow","handleClose","handleShow","checklogin","window","location","href","cookies","displaycartitems","setDisplayCartItems","sqleventid","setSqlEventId","tempArr","tempArrId","cookieProductArr","get","i","length","product","push","split","itemsPrice","reduce","a","c","qty","eventPrice","totalPrice","getEventIdServer","url","request","Request","Headers","Accept","temp","j","proId","eventtype","eventqty","proImg","replace","newDisplay","eventId","eventName","proName","proPrice","eventImg","eventType","onCookie","eventid","quantityNum","type","cookieEventId","updateCookie","cookieEvent","idSet","Set","add","has","eventjson","set","path","onCartNumChange","exist","find","x","filter","map","Number","onDelete","item","evt","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Cookies from 'universal-cookie'\nimport { Modal, Button } from 'react-bootstrap'\n\n// icon\nimport { FaRegEdit } from 'react-icons/fa'\nimport { FaLock } from 'react-icons/fa'\nimport { RiDeleteBinLine } from 'react-icons/ri'\n\nfunction BasketEvent() {\n  //假設會員id\n  const [memberid, setMemberId] = useState('')\n\n  //驗證身分\n  async function getjwtvertifyFromServer() {\n    const token = localStorage.getItem('token')\n\n    const response = await fetch(\n      'http://localhost:6005/users/checklogin',\n      {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          token,\n        }),\n      }\n    )\n\n    const data = await response.json()\n    console.log(data)\n    setMemberId(data.id)\n  }\n\n  useEffect(() => {\n    //驗證身分\n    getjwtvertifyFromServer()\n  }, [])\n\n  // Modal 顯示狀態\n  const [show, setShow] = useState(false)\n  // Modal 開關 function\n  const handleClose = () => setShow(false)\n  const handleShow = () => setShow(true)\n\n  // 確認有無登入\n  const checklogin = () => {\n    if (!memberid) {\n      console.log('請先登入會員')\n      handleShow()\n    } else {\n      window.location.href = './cart-form-product'\n    }\n  }\n\n  const cookies = new Cookies()\n  const [displaycartitems, setDisplayCartItems] = useState(\n    []\n  )\n  const [sqleventid, setSqlEventId] = useState('')\n\n  /**\n   * 當頁面Load時，讀取Cookie值並更新至cartItems\n   */\n  useEffect(() => {\n    let tempArr = []\n    let tempArrId = []\n    let cookieProductArr = cookies.get('product') // get Cookies\n\n    if (cookieProductArr) {\n      for (let i = 0; i < cookieProductArr.length; i++) {\n        let product = cookieProductArr[i]\n        tempArr.push(product)\n        tempArrId.push(product.id.split('-')[0])\n      }\n    }\n  }, [])\n\n  const itemsPrice = displaycartitems.reduce(\n    (a, c) => a + c.qty * c.eventPrice,\n    0\n  )\n  const totalPrice = itemsPrice\n\n  // 去後台SQL撈資料\n  async function getEventIdServer() {\n    // 連接的伺服器資料網址\n    const url = 'http://localhost:6005/product/product-list'\n\n    // 注意資料格式要設定，伺服器才知道是json格式\n    const request = new Request(url, {\n      method: 'GET',\n      headers: new Headers({\n        Accept: 'application/json',\n        'Content-Type': 'application/json',\n      }),\n    })\n    const response = await fetch(request)\n    // 再把response變成json\n    const data = await response.json()\n\n    let cookieProductArr = cookies.get('product')\n    var temp = []\n    if (cookieProductArr) {\n      for (let i = 0; i < data.length; i++) {\n        for (let j = 0; j < cookieProductArr.length; j++) {\n          let product = cookieProductArr[j]\n          setSqlEventId(product.id)\n\n          if (data[i].proId == product.id.split('-')[0]) {\n            let eventtype = product.id.split('-')[1]\n            let eventqty = product.qty\n            let proImg = data[i].proImg.replace(\n              /[\\[\\]\"]+/g,\n              ''\n            )\n            let newDisplay = {\n              id: data[i].id,\n              eventId: data[i].proId,\n              eventName: data[i].proName,\n              eventPrice: data[i].proPrice,\n              eventImg: proImg,\n              eventType: eventtype,\n              qty: eventqty,\n            }\n            temp.push(newDisplay)\n          }\n        }\n      }\n    }\n    setDisplayCartItems(temp)\n  }\n\n  useEffect(() => {\n    getEventIdServer('', '', '')\n  }, [])\n\n  /**\n   * 更新 event Cookie\n   *\n   * @param {Object} event 欲改變的目標 event.\n   * @param {number} quantityNum 欲更新event.qty到的數字.\n   * @param {string} type 根據不同type，event.qty 更新方法不同\n   *\n   *\n   */\n  const onCookie = (eventid, quantityNum, type) => {\n    console.log(eventid)\n    let cookieEventId = eventid + '-' + type\n    let updateCookie = []\n    let cookieEvent = cookies.get('product') // 取得 product cookie\n\n    if (cookieEvent) {\n      // 如果有已存在的 event cookie\n      // 查看cookie裡面的 event id\n      const idSet = new Set()\n      for (let i in cookieEvent) {\n        idSet.add(cookieEvent[i].id)\n      }\n      // event 在 event cookie 中\n      if (idSet.has(cookieEventId)) {\n        for (let i in cookieEvent) {\n          if (cookieEvent[i].id == cookieEventId) {\n            // 如果event是從Input,數量直接變成新數字\n            cookieEvent[i].qty = quantityNum\n          }\n        }\n      } else {\n        // 如果被改變的event 不在 event cookie 中\n        // 初始數量為1\n        let eventjson = {}\n        eventjson.id = cookieEventId\n        eventjson.qty = quantityNum\n        cookieEvent.push(eventjson)\n      }\n      // 如果被改變後的event數量>0，加入在cookie 中\n      for (let i in cookieEvent) {\n        if (cookieEvent[i].qty > 0) {\n          updateCookie.push(cookieEvent[i])\n        }\n      }\n    } else {\n      // 如果沒有已存在的 event cookie\n      // 初始數量為1\n      let eventjson = {}\n      eventjson.id = cookieEventId\n      eventjson.qty = quantityNum\n      updateCookie.push(eventjson)\n    }\n\n    cookies.set('product', updateCookie, { path: '/' }) //更新Cookie\n  }\n\n  /**\n   * 更新購物車數量\n   *\n   * @param {Object} event 欲改變的目標 event\n   * @param {number} quantityNum event.qty到的數字.\n   *\n   */\n  const onCartNumChange = (eventid, quantityNum, type) => {\n    const exist = displaycartitems.find(\n      (x) => x.eventId === eventid\n    )\n    console.log(displaycartitems)\n    onCookie(eventid, quantityNum, type)\n    if (quantityNum <= 0) {\n      setDisplayCartItems(\n        displaycartitems.filter(\n          (x) => x.eventId !== eventid\n        )\n      )\n    } else {\n      setDisplayCartItems(\n        displaycartitems.map((x) =>\n          x.eventId === eventid\n            ? { ...exist, qty: Number(quantityNum) }\n            : x\n        )\n      )\n    }\n  }\n\n  /**\n   * 移出購物車\n   *\n   * @param {Object} event 欲改變的目標 event.\n   *\n   */\n  const onDelete = (eventid, quantityNum, type) => {\n    onCookie(eventid, 0, type)\n    const exist = displaycartitems.find(\n      (x) =>\n        x.eventId + '-' + x.eventType ===\n        eventid + '-' + type\n    )\n    if (exist.qty >= 1) {\n      setDisplayCartItems(\n        displaycartitems.filter(\n          (x) =>\n            x.eventId + '-' + x.eventType !==\n            eventid + '-' + type\n        )\n      )\n    }\n  }\n\n  return (\n    <div>\n      {displaycartitems.length === 0 && (\n        <div className=\"c-empty\">您的購物車是空的</div>\n      )}\n      {displaycartitems.map((item) => (\n        <>\n          <div className=\"c-product-r1 d-block d-flex py-5 pl-4\">\n            <div className=\"c-img150\">\n              <img\n                src={`http://localhost:6005/productpics/${item.eventImg}`}\n                alt=\"\"\n              />\n            </div>\n            <div className=\"c-product1detail d-flex flex-column justify-content-between col-4 pl-4\">\n              <div>\n                <p className=\"h4\">{item.eventName}</p>\n                <p className=\"c-pid\">\n                  商品編號 # {item.eventId}\n                </p>\n\n                <p\n                  className={\n                    item.eventType === ''\n                      ? 'd-none'\n                      : 'mt-2'\n                  }\n                >\n                  尺寸：{item.eventType}\n                </p>\n              </div>\n              <div className=\"d-lg-flex\">\n                <a\n                  href=\"##\"\n                  className=\"c-product-a d-flex align-items-center\"\n                >\n                  <FaRegEdit size={20} />\n                  <p className=\"c-store2 ml-1 mr-4\">\n                    商品細節\n                  </p>\n                </a>\n                <a\n                  href=\"##\"\n                  className=\"c-product-a d-flex align-items-center\"\n                >\n                  <RiDeleteBinLine size={20} />\n                  <p\n                    onClick={() =>\n                      onDelete(\n                        item.eventId,\n                        0,\n                        item.eventType\n                      )\n                    }\n                    className=\"c-store2 ml-1 mr-4\"\n                  >\n                    移除商品\n                  </p>\n                </a>\n              </div>\n            </div>\n            <div className=\"c-price d-flex flex-column align-items-center col-2\">\n              <p className=\"mb-5\">價格</p>\n              <p>NT$ {item.eventPrice}</p>\n            </div>\n            <div className=\"c-quantity d-flex flex-column align-items-center col-2\">\n              <p className=\"mb-3 pb-3\">數量</p>\n              <div className=\"c-qbox\">\n                <input\n                  type=\"number\"\n                  value={item.qty}\n                  onChange={(evt) => {\n                    onCartNumChange(\n                      item.eventId,\n                      evt.target.value,\n                      item.eventType\n                    )\n                  }}\n                />\n              </div>\n            </div>\n            <div className=\"c-total d-flex flex-column align-items-center col-2\">\n              <p className=\"mb-5\">小計</p>\n              <p>NT$ {item.qty * item.eventPrice}</p>\n            </div>\n          </div>\n        </>\n      ))}\n\n      <div className=\"d-flex justify-content-between mt-3 pt-3 pb-5\">\n        <div className>\n          <a href=\"##\" className=\"c-store2 mr-5\">\n            聯絡客服\n          </a>\n          <a href=\"##\" className=\"c-store2 d-block mt-2\">\n            運費＆退貨條款\n          </a>\n        </div>\n        <div>\n          <p>\n            總計：\n            <sapn className=\"h4\">NT$ {totalPrice}</sapn>\n          </p>\n          <a\n            href=\"##\"\n            className=\"c-store2 d-block ml-5 mt-3\"\n          >\n            選取你的折扣碼\n          </a>\n        </div>\n      </div>\n      <div className=\"c-checkout pt-4 d-flex justify-content-between\">\n        <div className=\"d-flex align-items-center\">\n          <FaLock size={20} />\n          <p className=\"c-lock ml-1\">\n            本賣場使用綠界科技安全結帳系統，保障您的資安\n          </p>\n        </div>\n        <button\n          disabled={displaycartitems.length == 0}\n          onClick={checklogin}\n          className=\"c-checkoutbtn2\"\n        >\n          <a href=\"javascript:void(0)\">\n            <p>結帳</p>\n          </a>\n        </button>\n      </div>\n      <Modal\n        centered\n        show={show}\n        onHide={handleClose}\n        id=\"eventModal\"\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>請登入會員</Modal.Title>\n        </Modal.Header>\n        <Modal.Body>\n          <div>您目前還未登入會員，請登入會員進行結帳</div>\n        </Modal.Body>\n        <Modal.Footer>\n          <Button\n            type=\"button\"\n            className=\"e-btn-s e-modal-close\"\n            onClick={handleClose}\n          >\n            關閉\n          </Button>\n          <Button\n            type=\"button\"\n            className=\"e-btn-s e-modal-del\"\n            onClick={() => {\n              window.location.href = './user-login'\n            }}\n          >\n            登入\n          </Button>\n        </Modal.Footer>\n      </Modal>\n    </div>\n  )\n}\n\nexport default BasketEvent\n"]},"metadata":{},"sourceType":"module"}